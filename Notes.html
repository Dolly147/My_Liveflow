<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Notes</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <style>
    body {
      font-family: "Poppins", sans-serif;
    }
    .toast {
      animation: slideIn 0.3s ease-in-out;
    }
    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    .note-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      transition: all 0.3s ease;
    }
    .note-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
    }
  </style>
</head>

<body class="bg-white dark:bg-gray-900 min-h-screen">

  <!-- Toast Notification -->
  <div id="toast" class="hidden fixed top-4 right-4 z-50 toast">
    <div class="bg-gradient-to-r from-green-400 to-emerald-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2">
      <i class="fas fa-check-circle"></i>
      <span id="toastMessage"></span>
    </div>
  </div>

  <div class="max-w-6xl mx-auto p-6">
    <!-- Header -->
    <div class="flex justify-between items-center mb-8">
      <h1 class="text-4xl font-bold dark:text-white">üìù My Notes</h1>
      <button id="addNoteBtn"
        class="px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg font-semibold hover:shadow-lg transition-all hover:scale-105">
        <i class="fas fa-plus mr-2"></i>Add Note
      </button>
    </div>

    <!-- Notes Grid -->
    <div id="notesContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <div class="text-center py-12 col-span-full text-gray-500 dark:text-gray-400">
        <i class="fas fa-sticky-note text-5xl mb-4"></i>
        <p class="text-lg">No notes yet. Create one to get started!</p>
      </div>
    </div>
  </div>

  <!-- Add/Edit Modal -->
  <div id="noteModal" class="hidden fixed inset-0 bg-black/60 flex items-center justify-center z-50">
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-xl p-8 w-96 border border-gray-200 dark:border-gray-700">
      <h2 id="noteModalTitle" class="text-2xl font-bold mb-6 dark:text-white">Add New Note</h2>

      <input type="text" id="noteTitle" placeholder="Note title..."
        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 mb-4">

      <textarea id="noteContent" placeholder="Write your note here..." rows="8"
        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 mb-6 resize-none"></textarea>

      <div class="flex gap-3 justify-end">
        <button id="cancelNote"
          class="px-4 py-2 border border-gray-300 dark:border-gray-600 dark:text-white rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition">
          Cancel
        </button>
        <button id="saveNote"
          class="px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg font-semibold hover:shadow-lg transition-all">
          Save Note
        </button>
      </div>
    </div>
  </div>

  <script>
    (function() {
      const STORAGE_KEY = 'notes_v1';
      const modal = document.getElementById('noteModal');
      const addBtn = document.getElementById('addNoteBtn');
      const saveBtn = document.getElementById('saveNote');
      const cancelBtn = document.getElementById('cancelNote');
      const titleInput = document.getElementById('noteTitle');
      const contentInput = document.getElementById('noteContent');
      const container = document.getElementById('notesContainer');

      function showToast(message) {
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toastMessage');
        toastMessage.textContent = message;
        toast.classList.remove('hidden');
        setTimeout(() => {
          toast.classList.add('hidden');
        }, 3000);
      }

      function loadNotes() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          return raw ? JSON.parse(raw) : [];
        } catch(e) {
          return [];
        }
      }

      function saveNotes(notes) {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(notes));
      }

      function renderNotes() {
        const notes = loadNotes();
        container.innerHTML = '';

        if(notes.length === 0) {
          container.innerHTML = `
            <div class="text-center py-12 col-span-full text-gray-500 dark:text-gray-400">
              <i class="fas fa-sticky-note text-5xl mb-4"></i>
              <p class="text-lg">No notes yet. Create one to get started!</p>
            </div>
          `;
          return;
        }

        notes.forEach((note, idx) => {
          const div = document.createElement('div');
          div.className = 'note-card text-white p-6 rounded-lg cursor-pointer relative group';
          
          const preview = note.content.substring(0, 120) + (note.content.length > 120 ? '...' : '');
          const date = new Date(note.created).toLocaleDateString('en-US', { 
            month: 'short', 
            day: 'numeric',
            year: 'numeric'
          });

          div.innerHTML = `
            <div class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity flex gap-2">
              <button class="edit-note px-2 py-1 bg-white/20 rounded hover:bg-white/30 transition" data-idx="${idx}" title="Edit">
                <i class="fas fa-edit"></i>
              </button>
              <button class="delete-note px-2 py-1 bg-red-500/60 rounded hover:bg-red-500 transition" data-idx="${idx}" title="Delete">
                <i class="fas fa-trash"></i>
              </button>
            </div>

            <h3 class="font-bold text-lg mb-2 line-clamp-2">${note.title}</h3>
            <p class="text-sm opacity-90 line-clamp-4 mb-3">${preview}</p>
            <p class="text-xs opacity-75">${date}</p>
          `;

          container.appendChild(div);
        });

        // Delete event listener
        document.querySelectorAll('.delete-note').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.stopPropagation();
            const idx = parseInt(btn.getAttribute('data-idx'));
            if(confirm('Are you sure you want to delete this note?')) {
              const notes = loadNotes();
              notes.splice(idx, 1);
              saveNotes(notes);
              renderNotes();
              showToast('üóëÔ∏è Note deleted');
            }
          });
        });

        // Edit event listener
        document.querySelectorAll('.edit-note').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.stopPropagation();
            const idx = parseInt(btn.getAttribute('data-idx'));
            const notes = loadNotes();
            titleInput.value = notes[idx].title;
            contentInput.value = notes[idx].content;
            document.getElementById('noteModalTitle').textContent = 'Edit Note';
            saveBtn.setAttribute('data-edit-idx', idx);
            modal.classList.remove('hidden');
            titleInput.focus();
          });
        });
      }

      // Open Modal for new note
      addBtn.addEventListener('click', () => {
        titleInput.value = '';
        contentInput.value = '';
        document.getElementById('noteModalTitle').textContent = 'Add New Note';
        saveBtn.removeAttribute('data-edit-idx');
        modal.classList.remove('hidden');
        titleInput.focus();
      });

      // Close Modal
      cancelBtn.addEventListener('click', () => modal.classList.add('hidden'));

      // Save Note
      saveBtn.addEventListener('click', () => {
        const title = titleInput.value.trim();
        const content = contentInput.value.trim();

        if(!title) {
          showToast('‚ùå Please enter a title');
          return;
        }

        if(!content) {
          showToast('‚ùå Please write some content');
          return;
        }

        const notes = loadNotes();
        const editIdx = saveBtn.getAttribute('data-edit-idx');

        if(editIdx !== null) {
          notes[parseInt(editIdx)] = { 
            title, 
            content, 
            created: notes[parseInt(editIdx)].created,
            modified: Date.now()
          };
          showToast('‚úÖ Note updated');
        } else {
          notes.push({ 
            title, 
            content, 
            created: Date.now()
          });
          showToast('‚úÖ Note created');
        }

        saveNotes(notes);
        renderNotes();
        modal.classList.add('hidden');
      });

      // Close modal on Escape key
      document.addEventListener('keydown', (e) => {
        if(e.key === 'Escape') {
          modal.classList.add('hidden');
        }
      });

      // Initial render
      renderNotes();
    })();
  </script>

</body>

</html>
